<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="generator" content="Docutils 0.13.1: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 7952 2016-07-26 18:15:59Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS2.1_ stylesheet defines rules for Docutils elements without    */
/* HTML equivalent. It is required to make the document semantic visible. */
/*                                                                        */
/* .. _CSS2.1: http://www.w3.org/TR/CSS2                                  */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link       */

/* alignment of text and inline objects inside block objects*/
.align-left   { text-align: left; }
.align-right  { text-align: right; }
.align-center { clear: both; text-align: center; }
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* titles */
h1.title, p.subtitle {
  text-align: center;
}
p.admonition-title,
p.topic-title,
p.sidebar-title,
p.rubric,
p.system-message-title {
  font-weight: bold;
}
h1 + p.subtitle,
h1 + p.section-subtitle {
  font-size: 1.6em;
}
h2 + p.section-subtitle { font-size: 1.28em; }
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
p.sidebar-title,
p.rubric {
  font-size: larger;
}
p.rubric { color: maroon; }
a.toc-backref {
  color: black;
  text-decoration: none; }

/* Warnings, Errors */
div.caution p.admonition-title,
div.attention p.admonition-title,
div.danger p.admonition-title,
div.error p.admonition-title,
div.warning p.admonition-title,
div.system-messages h1,
div.error,
span.problematic,
p.system-message-title {
  color: red;
}

/* inline literals */
span.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wraph at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .compact li,
.simple  ul, .compact ul,
.simple  ol, .compact ol,
.simple > li p, .compact > li p,
dl.simple > dd, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}

/* Table of Contents */
div.topic.contents { margin: 0; }
ul.auto-toc {
  list-style-type: none;
  padding-left: 1.5em; }

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

dt span.classifier { font-style: italic }
dt span.classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}

/* Field Lists and drivatives */
/* bold field name, content starts on the same line */
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt,
dl.footnote > dt,
dl.citation > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples */
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}
/* field names followed by a colon */
dl.field-list > dt:after,
dl.docinfo > dt:after {
  content: ":";
}

/* Bibliographic Fields (docinfo) */
pre.address { font: inherit; }
dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list { margin-left: 40px; }
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */
dl.footnote.superscript > dd {margin-left: 1em; }
dl.footnote.brackets > dd {margin-left: 2em; }
dl > dt.label { font-weight: normal; }
a.footnote-reference.brackets:before,
dt.label > span.brackets:before { content: "["; }
a.footnote-reference.brackets:after,
dt.label > span.brackets:after { content: "]"; }
a.footnote-reference.superscript,
dl.footnote.superscript > dt.label {
  vertical-align: super;
  font-size: smaller;
}
dt.label > span.fn-backref { margin-left: 0.2em; }
dt.label > span.fn-backref > a { font-style: italic; }

/* Line Blocks */
div.line-block { display: block; }
div.line-block div.line-block {
  margin-top: 0;
  margin-bottom: 0;
  margin-left: 40px;
}

/* Figures, Images, and Tables */
.figure.align-left,
img.align-left,
object.align-left,
table.align-left {
  margin-right: auto;
}
.figure.align-center,
img.align-center,
object.align-center {
  margin-left: auto;
  margin-right: auto;
  display: block;
}
table.align-center {
  margin-left: auto;
  margin-right: auto;
}
.figure.align-right,
img.align-right,
object.align-right,
table.align-right {
  margin-left: auto;
}
/* reset inner alignment in figures and tables */
div.align-left, div.align-center, div.align-right,
table.align-left, table.align-center, table.align-right
{ text-align: inherit }

/* Admonitions and System Messages */
div.admonition,
div.system-message,
div.sidebar{
  margin: 40px;
  border: medium outset;
  padding-right: 1em;
  padding-left: 1em;
}

/* Sidebar */
div.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
}

/* Text Blocks */
div.topic,
pre.literal-block,
pre.doctest-block,
pre.math,
pre.code {
  margin-right: 40px;
  margin-left: 40px;
}
pre.code .ln { color: gray; } /* line numbers */

/* Tables */
table { border-collapse: collapse; }
td, th {
  border-style: solid;
  border-color: silver;
  padding: 0 1ex;
  border-width: thin;
}
td > p:first-child, th > p:first-child { margin-top: 0; }
td > p, th > p { margin-bottom: 0; }

table > caption {
  text-align: left;
  margin-bottom: 0.25em
}

table.borderless td, table.borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.		   */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 7952 2016-07-26 18:15:59Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*    	     	      	     	 					   */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: http://www.w3.org/TR/CSS3		        		   */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  padding: 0 5%;
  margin: 8px 0;
}
div.document {
  line-height:1.3;
  counter-reset: table;
  /* counter-reset: figure; */
  /* avoid long lines --> better reading */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50em;
  margin: auto;
}

/* Sections */

/* Transitions */

hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs               */
/* ==========               */

/* vertical space (parskip) */
p, ol, ul, dl,
div.line-block,
table{
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
h1, h2, h3, h4, h5, h6,
dl > dd {
  margin-bottom: 0.5em;
}

/* Lists                    */
/* ==========               */

/* Definition Lists         */

dl > dd p:first-child { margin-top: 0; }
/* :last-child is not part of CSS 2.1 (introduced in CSS 3) */
/* dl > dd p:last-child  { margin-bottom: 0; } */

/* lists nested in definition lists */
/* :only-child is not part of CSS 2.1 (introduced in CSS 3) */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}

/* Field Lists */

/* example for custom field-name width */
dl.field-list.narrow > dd {
  margin-left: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use special definition list dl.docinfo */
/* but dedication and abstract are placed into "topic" divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* Citations */
dl.citation dt.label {
  font-weight: bold;
}
span.fn-backref {
  font-weight: normal;
}

/* Text Blocks           */
/* ============          */

/* Literal Blocks           */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  margin-left: 1.5em;
  margin-right: 1.5em
}

/* Block Quotes             */

blockquote,
div.topic {
  margin-left: 1.5em;
  margin-right: 1.5em
}
blockquote > table,
div.topic > table {
  margin-top: 0;
  margin-bottom: 0;
}
blockquote p.attribution,
div.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables                   */
/* ======                   */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks   */
/* ======================   */

/* Footnotes and Citations  */
/* -----------------------  */

/* line on the left */
dl.footnote {
  padding-left: 1ex;
  border-left: solid;
  border-left-width: thin;
}

/* Directives               */
/* ----------               */

/* Body Elements            */
/* ~~~~~~~~~~~~~            */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
.figure.align-left,
img.align-left,
object.align-left {
  display: block;
  clear: left;
  float: left;
  margin-right: 1em
}
.figure.align-right,
img.align-right,
object.align-right {
  display: block;
  clear: right;
  float: right;
  margin-left: 1em
}
/* Stop floating sidebars, images and figures at section level 1,2,3 */
h1, h2, h3 { clear: both; }

/* Sidebar */

/* Move into the margin. In a layout with fixed margins, */
/* it can be moved into the margin completely.		 */
div.sidebar {
  width: 30%;
  max-width: 26em;
  margin-left: 1em;
  margin-right: -5.5%;
  background-color: #ffffee ;
}

/* Code                     */

pre.code, code { background-color: #eeeeee }
pre.code .ln { color: gray; } /* line numbers */
/* basic highlighting: for a complete scheme, see */
/* http://docutils.sourceforge.net/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math                     */
/* styled separately (see math.css for math-output=HTML) */

/* Epigraph                 */
/* Highlights               */
/* Pull-Quote               */
/* Compound Paragraph       */
/* Container                */

/* can be styled in a custom stylesheet */

/* Document Header and Footer */

div.footer, div.header {
  clear: both;
  font-size: smaller;
}

/* Inline Markup            */
/* =============            */

/* Emphasis                 */
/*   em                     */
/* Strong Emphasis          */
/*   strong		    */
/* Interpreted Text         */
/*   span.interpreted  	    */
/* Title Reference 	    */
/*   cite		    */
/* Inline Literals          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; } */

/* Hyperlink References     */
a { text-decoration: none; }

/* External Targets         */
/*   span.target.external   */
/* Internal Targets  	    */
/*   span.target.internal   */
/* Footnote References      */
/*   a.footnote-reference   */
/* Citation References      */
/*   a.citation-reference   */

</style>
</head>
<body>
<div class="document">


<div class="section" id="interface-format-descriptions">
<h1>Interface/Format Descriptions</h1>
<p>This document combines three purposes. Maybe it should be split
up later... The first purpose is to describe some basic ideas
for the codebase to ensure consistency so we can all understand
the HDL written by each other. The other purpose is to start
detailing out the interfaces for the various blocks that we will
be using. Finally, I am starting preliminary descriptions of the
blocks and the interfaces that they will support.</p>
<p>Before getting started, I want to clear up a few things. Most of
what is included in this document is applicable to the signal
processing sections of the design. It may not be applicable to
other sections. Always do what makes the most sense. The
suggestions here are things that I have found to be helpful.
Part of the help is simply having a consistent codebase that
everyone can understand quickly and easily.</p>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr><th class="head"><p>Are these hard-and-fast rules or are they flexible?</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Ultimately, the designer/developer has flexibility to do what
he or she feels is correct. Just be ready to defend the
decision if someone challenges it. In the end, we want
designs that make sense, so do what makes sense. Usually,
following these guidelines is correct. The goal is to keep
your HDL consistent, portable, flexible, and easy for others
to understand. If these goals are serviced better by breaking
some rules, then do what makes sense.</p></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr><th class="head"><p>Why do we need common well-defined interfaces?</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>We need common interfaces to ensure interoperability of our
blocks. This will also aid in reordering them if required.
Plus, it helps us as developers share a common language for
the design. This helps us to avoid ambiguity and hand-waving
when we are talking about the design. Ambiguity is the enemy.</p></td>
</tr>
</tbody>
</table>
<p>Without further ado, let's get started...</p>
<div class="section" id="registers-at-block-interfaces">
<h2>Registers at Block Interfaces</h2>
<p>It is a good idea to have registers at the interfaces of larger
blocks in the design hierarchy. This means that the input and
output signals are all tied to registers. This makes it easier
to guarantee that a design will meet timing. Unfortunately, it
may not always be possible.</p>
<p>If combinatorial outputs are required for some reason (i.e.,
to meet a real-time schedule at the same rate as the clock
frequency), then use them. If they are not required, then
please register your outputs.</p>
<p>If there is a choice between either registering inputs or
outputs, it should be preferred to register the output. If we
are all consistent about this, then it will allow us to have
much better (consistent) estimates of the clock periods that
we are able to achieve with our blocks.</p>
<p>Note: Combinatorial inputs/outputs are okay for submodules
that are components of a larger module. The timing of the
larger module should be verified after synthesis. Then these
submodules become a part of it (i.e., they are not necessarily
intended for reuse elsewhere in the design).</p>
<p>The goal here is to keep timing estimates consistent and
to keep our blocks modular so we can reuse code when possible
in different parts of the design.</p>
</div>
<div class="section" id="port-direction-inference">
<h2>Port Direction Inference</h2>
<p>Port directions are inferred by their prefix. A prefix of <em>i_</em>
indicates that the port is an input. A prefix of <em>o_</em> indicates
that the port is an output. A prefix of <em>b_</em> indicates an inout
port.</p>
<p>Here is an example:</p>
<pre class="literal-block">module test (
    input wire logic          i_clock,
    input wire logic          i_reset,
    input wire logic [15:0]   i_data,
    input wire logic          i_valid,
    output     logic          o_ready,
    output     logic [31:0]   o_data,
    output     logic          o_valid,
    input wire logic          i_ready
);</pre>
</div>
<div class="section" id="polarity-inference">
<h2>Polarity Inference</h2>
<p>Port polarity is inferred by a suffix or a lack thereof. The suffix
<em>_n</em> indicates an active low signal. The optional suffix <em>_p</em> indicates
an active high signal. This is optional, since by default, we assume
all signals are active high.</p>
<p>The polarity inference suffix is applied along with the port direction
prefix. For example, if we had a module with an active low reset, we
would declare it as follows:</p>
<pre class="literal-block">module test (
    input wire logic          i_clock,
    input wire logic          i_reset_n,
    input wire logic [15:0]   i_data,
    input wire logic          i_valid,
    output     logic          o_ready,
    output     logic [31:0]   o_data,
    output     logic          o_valid,
    input wire logic          i_ready
);</pre>
<p>The same holds true for signals local to a module. If there is an
active low signal local to a module, use the suffix <em>_n</em> to
distinguish it from other local active high logic signals.</p>
</div>
<div class="section" id="default-net-type">
<h2>Default Net Type</h2>
<p>It is preferable to use code that invokes the SystemVerilog directive
to change the default net type to nothing. This is to avoid typos that
can lead to undesired behavior when a net is inferred but has not been
defined. We also follow the idea that explicit declaration of the nets
we want is a good idea from a debugging and code maintenance
point-of-view.</p>
<p>An example of invoking this on an empty module is:</p>
<pre class="literal-block">`default_nettype none

module name();
endmodule: name

`default_nettype wire</pre>
<p>Be sure to set the default back to wire before the end of the file.
Otherwise, the parser/synthesizer/simulator may have unpredictable
behavior on other modules. This is because the default net type is a
global directive.</p>
</div>
<div class="section" id="complex-valued-conventions">
<h2>Complex-Valued Conventions</h2>
<p>When bundling together complex-valued data, there are two fields.
In rectangular format, these are the real and imaginary parts.
In polar format, these are the magnitude and angle. The convention
that we follow for bundling under rectangular format is that the
real part should occupy the least significant word and the
imaginary part should occupy the most significant word. The
convention that we follow for polar format is that the magnitude
should occupy the least significant word and the angle should
occupy the most significant word. For example, if we had a 16-bit
real and a 16-bit imaginary part, we would use the following
representation:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr><th class="head"><p>Bits 31 down to 16</p></th>
<th class="head"><p>Bits 15 down to 0</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>16-bit imaginary part</p></td>
<td><p>16-bit real part</p></td>
</tr>
</tbody>
</table>
<p>The choice of 32-bit numbers here was arbitrary. It is not a
requirement. The numbers could other lengths, and they need
not be symmetrical. For example, the following representation
still adheres to the convention:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr><th class="head"><p>Bits 20 down to 16</p></th>
<th class="head"><p>Bits 15 down to 0</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>4-bit imaginary part</p></td>
<td><p>16-bit real part</p></td>
</tr>
</tbody>
</table>
<p>If we had a 24-bit magnitude and an 8-bit angle, we would
represent this as:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr><th class="head"><p>Bits 31 down to 24</p></th>
<th class="head"><p>Bits 23 down to 0</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>8-bit angle</p></td>
<td><p>24-bit magnitude</p></td>
</tr>
</tbody>
</table>
<p>This convention only applies when bundling these fields together
in the HDL. It doesn't apply if they are defined as separate
fields for example:</p>
<pre class="literal-block">logic [15:0] inph;
logic [15:0] quad;</pre>
<p>This still follows the convention since these are individual
signals. If these were going to be concatenated, then we would
use the following to adhere to the convention:</p>
<pre class="literal-block">logic [31:0] complex_sample;
assign complex_sample = {
    quad, inph
};</pre>
<p>Or equivalently:</p>
<pre class="literal-block">logic [31:0] complex_sample;
assign complex_sample[31:16] = quad;
assign complex_sample[15:0] = inph;</pre>
</div>
<div class="section" id="polarity-convention">
<h2>Polarity Convention</h2>
<p>Logic signals are active high unless there is a compelling reason
to make them active low. Active low logic must be indicated with the
<em>_n</em> suffix as noted in the Polarity Inference section.</p>
<p>When interfacing to another chip that requires an active low signal,
the internal logic in the FPGA should be active high and then
inverted at the chip boundary unless there is a very good reason.</p>
<p>When exposing active low pins to software via a register interface,
the signal should be inverted in the FPGA so that the software sees
it as active high.</p>
</div>
<div class="section" id="reset-convention">
<h2>Reset Convention</h2>
<p>Resets should be synchronous unless there is a compelling reason
to make them otherwise. If a reset is asserted asynchronously, it
should still be deasserted synchronously in the clock domain that
it resides in. This should be handled by the HDL in that module.
For most modules, synchronous resets are preferred.</p>
</div>
<div class="section" id="valid-ready-handshake">
<h2>Valid/Ready Handshake</h2>
<p>This method of transfer allows for flow control (i.e.,
regulation of the data transfer) to occur in either
direction. It is possible and acceptable to associate
multiple data fields with a single valid/ready handshake.
For example, if there is an in_phase and quadrature field
on a complex baseband signal, then both are likely to be
associated with the same valid/ready handshake.</p>
<p>The basic idea of the valid/ready handshake is that data is
transferred on a clock cycle when valid and ready are both
high. Data is not transferred on a clock cycle when this is
not true. If the valid signal is asserted, it must remain
asserted until the ready signal is asserted. The ready signal
may wait for the valid signal to go high before being asserted,
but the valid signal may not wait for the ready signal to go
high before being asserted. These conditions prevent lock up
from occurring. Lock up is a state when both the upstream and
downstream blocks are waiting to hear from each other, but
neither takes the initiative. The upstream block is always
responsible to initiate transactions (although the downstream
block may advertise itself as ready or not). This handshake
is modeled after the AXI Stream standard, but we don't require
that data fields are multiples of bytes, and we have limited
the number of fields to three: data, valid, and ready.</p>
<p><strong>Note:</strong> A valid/ready handshake indicates a single transfer may
take place. If on the next cycle, the valid or ready signal is
driven low, then a transfer does not occur on that clock cycle.
For bursting behavior see the valid/ready burst interface.</p>
<p>A SystemVerilog interface that exemplifies this is given next:</p>
<pre class="literal-block">interface intf_vr();

    parameter integer WIDTH = 16;

    logic [WIDTH-1:0]   data;
    logic               valid;
    logic               ready;

    modport upstream(
        output valid, data,
        input  ready
    );

    modport downstream(
        input  valid, data,
        output ready
    );

endinterface: intf_vr</pre>
<p>If SystemVerilog interfaces are not well supported by the tools,
then we will just mimic them by using the names with prefixes. For
example:</p>
<pre class="literal-block">module upstream_module (
    input  wire logic       i_clock,
    input  wire logic       i_reset,
    output      logic [7:0] o_sample_data,
    output      logic       o_sample_valid,
    input  wire logic       i_sample_ready
);
endmodule

module downstream_module (
    input  wire logic       i_clock,
    output      logic       i_reset,
    input  wire logic [7:0] i_sample_data,
    input  wire logic       i_sample_valid,
    output      logic       o_sample_ready
);
endmodule</pre>
<p>Some blocks will only support flow regulation in one direction
or the other (either upstream or downstream only). These can be
implemented by tying a ready/valid signal high or by simply leaving
it off the port map. Anything left off the port map is assumed to
be driven by a constant high value. The preferred implementation is
to leave the port off of the port map.</p>
<p>Do not name signals valid and ready unless they have the semantics
indicated in this section. It will just confuse us.</p>
</div>
<div class="section" id="valid-ready-bursting">
<h2>Valid/Ready Bursting</h2>
<p>The Valid/Ready Bursting interface indicates that a burst transaction
is required. Using this interface creates a contractual agreement
between two blocks that the burst will occur completely without
push back or gaps in the transmission. It is also possible to
use the Valid/Ready Handshake for bursts, but the contract between
those blocks is that push back and gaps in the valid signal are
allowed. For example, the FFT output and a cyclic prefix buffer
might use this type of bursting interface.</p>
<p>There is a one-to-one correspondence between the signals in the
Valid/Ready Burst and the signals in the Valid/Ready Handshake
described above, but we have changed their names to indicate that
they are part of the burst interface. We prefixed their names
with a <em>b</em> to set them apart from the handshaking signals. Thus,
the signal names are bvalid, bready, and bdata. This prefix is
to help avoid developer confusion.</p>
<p>For this interface, when bvalid and bready are both high, a burst is
initiated. Following this, bready should go low, while bvalid remains
high until the entire burst has been transferred. The downstream block
must consume the entire burst (if bready is asserted, then the block
is advertising that it has sufficient space). The bvalid signal
remains high for the duration of the burst. If another burst is
ready, the bvalid signal will remain high after the burst is complete.
The same rules as in the Valid/Ready Handshake apply here to avoid lock
up. The bvalid signal cannot wait on the bready signal. Once bvalid is
asserted, it cannot be deasserted until the transfer has occurred
(except in the case of a reset being asserted).</p>
<p>A SystemVerilog interface that exemplifies this is given next:</p>
<pre class="literal-block">interface intf_burst();

    parameter integer WIDTH = 16;

    logic [WIDTH-1:0]   bdata;
    logic               bvalid;
    logic               bready;

    modport upstream(
        output bvalid, bdata,
        input  bready
    );

    modport downstream(
        input  bvalid, bdata,
        output bready
    );

endinterface: intf_burst</pre>
<p>And a pair of verilog modules that exemplifies this is given here:</p>
<pre class="literal-block">module upstream_module (
    input  wire logic        i_clock,
    input  wire logic        i_reset,
    output      logic [31:0] o_sample_bdata,
    output      logic        o_sample_bvalid,
    input  wire logic        i_sample_bready
);
endmodule

module downstream_module (
    input  wire logic        i_clock,
    output      logic        i_reset,
    input  wire logic [31:0] i_sample_bdata,
    input  wire logic        i_sample_bvalid,
    output      logic        o_sample_bready
);
endmodule</pre>
<p>Do not name signals bvalid and bready unless they have the semantics
indicated in this section. It will just confuse us.</p>
<p>The burst size is not part of the interface, but is an important part
of the module. It will either be a fixed number built in to the module
or a module parameter (if it can be changed when instantiated). If it
is fixed in the module, then it will typically be included in the
module name. For example, if the bursts represent frames of an FFT
and the size is fixed at 1024. Then the FFT module should be named
something like fft_1024. On the other hand, if the size is
parameterizable, then it should be added to the parameter list when
instantiating the module. This will make the burst length clear to
the uninitated, and make the code more user friendly.</p>
</div>
</div>
<div class="section" id="system-block-module-descriptions">
<h1>System Block/Module Descriptions</h1>
<div class="section" id="generic-blocks">
<h2>Generic Blocks</h2>
<p>This section describes blocks that belong neither to the
transmitter nor the receiver, but are still a part of the
overall system design.</p>
<div class="section" id="system-timer">
<h3>System Timer</h3>
<p>The system clock continuously increments until it is reset
by the dedicated reset. There is an independent system timer
in each FPGA, but they should all share a common reset and
should therefore be synchronous giving us a global reference
for event scheduling.</p>
<p>Ports:</p>
<ul class="simple">
<li><p>i_clock (clock)</p></li>
<li><p>i_reset (1-bit input)</p></li>
<li><p>i_enable (1-bit input)</p></li>
<li><p>o_timer_count (64-bit output)</p></li>
</ul>
<p>Associated Registers:</p>
<ul>
<li><p>LSBs</p>
<blockquote>
<ul class="simple">
<li><p>Use this register to read out the least significant bits of the system timer without side effects. Only use this register if you do not need the MSBs as well.</p></li>
</ul>
</blockquote>
</li>
<li><p>MSBs</p>
<blockquote>
<ul class="simple">
<li><p>Use this register to read out the most significant bits of the system timer without side effects. Only use this register if you do not need the LSBs as well.</p></li>
</ul>
</blockquote>
</li>
<li><p>MSBs then LSBs</p>
<blockquote>
<ul class="simple">
<li><p>Read this register twice in succession to first read the MSBs, and then the associated LSBs. The LSBs are frozen when the MSBs are read until the register is read again. This is done to guarantee a synchronous read of both registers. This is the register to use if you need both LSBs and MSBs read synchronously.</p></li>
</ul>
</blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="transmitter-blocks">
<h2>Transmitter Blocks</h2>
<p>This section describes blocks that are part of the transmitter design.</p>
<div class="section" id="packet-buffers">
<h3>Packet Buffers</h3>
<p>The purpose of the packet buffers is to delay the transmit chain
processing until a complete packet is ready to be consumed to avoid
starving any stage of the design while waiting for more data to
arrive. This is important in order to meet the real-time constraints
of the DAC.</p>
<p>Ports:</p>
<ul class="simple">
<li><p>i_clock (clock)</p></li>
<li><p>i_reset (active-high reset)</p></li>
<li><p>i_byte (8-bit input)</p></li>
<li><p>i_byte_valid (1-bit input)</p></li>
<li><p>o_byte_ready (1-bit output)</p></li>
<li><p>o_byte (8-bit input)</p></li>
<li><p>o_byte_valid (1-bit output)</p></li>
<li><p>i_byte_ready (1-bit output)</p></li>
</ul>
<p>Associated Registers:</p>
<ul>
<li><p>Bytes per Packet Less One (32-bit)</p>
<blockquote>
<ul class="simple">
<li><p>A register that indicates how many bytes can be stuffed into a single packet. The number of bytes is actually the value of the register plus one. So, zero corresponds to one, 999 corresponds to 1000, and so on.</p></li>
</ul>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="scrambler">
<h3>Scrambler</h3>
<p>The scrambler scrambles the input data sequence to ensure that it
appears to be more random when it is transmitted over the channel.
This improves the signal Peak-to-Average Power Ratio (PAPR).</p>
<p>The scrambler design that we will use takes 8-bit inputs and
scrambles them to produce 8-bit outputs.</p>
<p>Ports:</p>
<ul class="simple">
<li><p>i_clock (clock)</p></li>
<li><p>i_reset (active-high reset)</p></li>
<li><p>i_byte (8-bit input)</p></li>
<li><p>i_byte_valid (1-bit input)</p></li>
<li><p>o_byte_ready (1-bit output)</p></li>
<li><p>o_byte (8-bit output)</p></li>
<li><p>o_byte_valid (1-bit output)</p></li>
<li><p>i_byte_ready (1-bit input)</p></li>
</ul>
</div>
<div class="section" id="ldpc-encoder">
<h3>LDPC Encoder</h3>
</div>
<div class="section" id="qam-symbol-mapper">
<h3>QAM Symbol Mapper</h3>
</div>
<div class="section" id="subcarrier-mapper">
<h3>Subcarrier Mapper</h3>
</div>
<div class="section" id="inverse-fast-fourier-transform">
<h3>Inverse Fast Fourier Transform</h3>
</div>
<div class="section" id="cyclic-prefixer">
<h3>Cyclic Prefixer</h3>
</div>
<div class="section" id="sample-turnstile">
<h3>Sample Turnstile</h3>
<p>Like a turnstile, this block will apply back pressure
on the upstream blocks and pass only zeros until a set
of conditions is met. There is a condition to turn it
on at a specific count of the system clock. There is a
condition to turn it off after it has been on for a
specific set of clock counts (corresponding to the
rotation of the turnstile).</p>
<p>The sample turnstile assumes that data is always ready
for its consumption. In general, this should be true if
the system doesn't raise the enable right away.</p>
<p>Ports:</p>
<ul class="simple">
<li><p>i_sample_inph (16-bit input)</p></li>
<li><p>i_sample_quad (16-bit input)</p></li>
<li><p>o_sample_ready (1-bit output)</p></li>
<li><p>o_sample_inph (16-bit output)</p></li>
<li><p>o_sample_quad (16-bit output)</p></li>
<li><p>i_enable (1-bit input)</p></li>
<li><p>i_reset (1-bit input)</p></li>
</ul>
<p>Associated registers:</p>
<ul>
<li><p>Trigger Time (in units of the system clock)</p>
<blockquote>
<ul class="simple">
<li><p>When System Clock equals Trigger Time, samples pass through the block</p></li>
</ul>
</blockquote>
</li>
<li><p>On-Air Time (in units of the system clock)</p>
<blockquote>
<ul class="simple">
<li><p>If samples are passing through the block and System Clock equals On-Air Time, then the turnstile is locked and samples stop passing through.</p></li>
</ul>
</blockquote>
</li>
<li><p>Bypass</p>
<blockquote>
<ul class="simple">
<li><p>If bypass is set to one and the turnstile is enabled, samples pass through unimpeded.</p></li>
</ul>
</blockquote>
</li>
<li><p>Enable (active high)</p>
<blockquote>
<ul class="simple">
<li><p>If enable is high, the turnstile is enabled. If enable is low, the turnstile is disabled. If the turnstile is disabled, it outputs zeros and advertises to upstream blocks that it is not ready to accept data.</p></li>
</ul>
</blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="receiver-blocks">
<h2>Receiver Blocks</h2>
<p>This section describes blocks that are part of the receiver design.</p>
<p><strong>To be completed...</strong></p>
</div>
</div>
</div>
</body>
</html>
